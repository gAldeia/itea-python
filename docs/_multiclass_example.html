<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Iris classification &mdash; Interaction-Transformation Evolutionary Algorithm</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="California housing regression" href="_regression_example.html" />
    <link rel="prev" title="Interacting with ProtoDash" href="_interacting_with_protodash.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> ITEA: Interaction-Transformation Evolutionary Algorithm
            <img src="_static/itea-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                latest
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="gettingstarted.html#minimal-examples">Minimal examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ITEA package documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="base.html">itea._base</a></li>
<li class="toctree-l1"><a class="reference internal" href="itea.regression.html">itea.regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="itea.classification.html">itea.classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="itea.inspection.html">itea.inspection</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example notebooks:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="_agnostic_explainers.html">Using agnostic explainers</a></li>
<li class="toctree-l1"><a class="reference internal" href="_explanations_metrics.html">Explanations metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="_integrating_with_scikits_classes.html">Integrating with the Scikit: Pipeline and Gridsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="_interacting_with_protodash.html">Interacting with ProtoDash</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Iris classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="_regression_example.html">California housing regression</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ITEA: Interaction-Transformation Evolutionary Algorithm</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Iris classification</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/_multiclass_example.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Iris-classification">
<h1>Iris classification<a class="headerlink" href="#Iris-classification" title="Permalink to this heading"></a></h1>
<p>This notebook will walk through the process of using the ITEA for classification (<code class="docutils literal notranslate"><span class="pre">ITEA_classifier</span></code>) and interpreting the final expression with the <code class="docutils literal notranslate"><span class="pre">itea.inspection</span></code> tools.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># automatically differentiable implementation of numpy</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span> <span class="c1"># v0.2.13</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">IPython.display</span>         <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">Latex</span>

<span class="kn">from</span> <span class="nn">itea.classification</span> <span class="kn">import</span> <span class="n">ITEA_classifier</span>
<span class="kn">from</span> <span class="nn">itea.inspection</span>     <span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;itea&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We will use the Iris data set in this example.</p>
<p>This data set contains 3 different classes of Iris flowers and has 4 features: sepal width, sepal length, petal width, and petal length.</p>
<p>One example of each flower is illustrated in the figure below.</p>
<p><img alt="image0" src="https://s3.amazonaws.com/assets.datacamp.com/blog_assets/Machine+Learning+R/iris-machinelearning.png" /></p>
<section id="Creating-and-fitting-an-ITEA_classifier">
<h2>Creating and fitting an <code class="docutils literal notranslate"><span class="pre">ITEA_classifier</span></code><a class="headerlink" href="#Creating-and-fitting-an-ITEA_classifier" title="Permalink to this heading"></a></h2>
<p>In this execution, we will fix the random_state argument to allow reproductible executions of the ITEA algorithm.</p>
<p>The IT expression is used as the decision function in a logistic regression. The inner logistic regression uses the saga solver described in <em>“Defazio, A., Bach F. &amp; Lacoste-Julien S. (2014). SAGA: A Fast Incremental Gradient Method With Support for Non-Strongly Convex Composite Objectives”</em>.</p>
<p>The method will solve a <strong>multinomial</strong> classification problem with the softmax funcion applied over the decision function. By default, no regularization os performed (although the user can controlate this by setting values to alpha and beta parameters), and a maximum of 100 iterations of the saga solver is performed for each expression.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris_data</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span>      <span class="o">=</span> <span class="n">iris_data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">iris_data</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
<span class="n">labels</span>    <span class="o">=</span> <span class="n">iris_data</span><span class="p">[</span><span class="s1">&#39;feature_names&#39;</span><span class="p">]</span>
<span class="n">targets</span>   <span class="o">=</span> <span class="n">iris_data</span><span class="p">[</span><span class="s1">&#39;target_names&#39;</span><span class="p">]</span>

<span class="c1"># changing numbers to the class names</span>
<span class="n">y_targets</span> <span class="o">=</span> <span class="p">[</span><span class="n">targets</span><span class="p">[</span><span class="n">yi</span><span class="p">]</span> <span class="k">for</span> <span class="n">yi</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y_targets</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Creating transformation functions for ITEA using jax.numpy</span>
<span class="c1"># (so we don&#39;t need to analytically calculate its derivatives)</span>
<span class="n">tfuncs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;id&#39;</span>       <span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span>
    <span class="s1">&#39;sqrt.abs&#39;</span> <span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span>
    <span class="s1">&#39;log&#39;</span>      <span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">,</span>
    <span class="s1">&#39;exp&#39;</span>      <span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span>
<span class="p">}</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">ITEA_classifier</span><span class="p">(</span>
    <span class="n">gens</span>            <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
    <span class="n">popsize</span>         <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
    <span class="n">max_terms</span>       <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">expolim</span>         <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">verbose</span>         <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">tfuncs</span>          <span class="o">=</span> <span class="n">tfuncs</span><span class="p">,</span>
    <span class="n">labels</span>          <span class="o">=</span> <span class="n">labels</span><span class="p">,</span>
    <span class="n">simplify_method</span> <span class="o">=</span> <span class="s1">&#39;simplify_by_var&#39;</span><span class="p">,</span>
    <span class="n">fit_kw</span>          <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;max_iter&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">},</span>
    <span class="n">random_state</span>    <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
gen | smallest fitness | mean fitness | highest fitness | remaining time
----------------------------------------------------------------------------
  0 |         0.560000 |     0.848200 |        0.970000 | 0min32sec
  5 |         0.740000 |     0.961800 |        0.980000 | 0min22sec
 10 |         0.790000 |     0.969400 |        0.990000 | 0min23sec
 15 |         0.950000 |     0.982200 |        0.990000 | 0min17sec
 20 |         0.890000 |     0.982200 |        0.990000 | 0min18sec
 25 |         0.860000 |     0.982400 |        0.990000 | 0min18sec
 30 |         0.930000 |     0.981800 |        0.990000 | 0min11sec
 35 |         0.960000 |     0.982600 |        0.990000 | 0min8sec
 40 |         0.940000 |     0.981600 |        0.990000 | 0min5sec
 45 |         0.660000 |     0.973800 |        0.990000 | 0min2sec
</pre></div></div>
</div>
<p>Since the <code class="docutils literal notranslate"><span class="pre">ITEA_classifier</span></code> and the best solution found by the ITEA <code class="docutils literal notranslate"><span class="pre">ITExpr_classifier</span></code> are both scikit-like models, we can use some base methods like <code class="docutils literal notranslate"><span class="pre">get_params</span></code>.</p>
<p>In the cell below we inspect the parameters of the best expression. We can see the logistic regression regularization parameters (alpha and beta), the maximum number of iterations of the coefficients adjustment algorithm (max_iter), and the array of IT terms (expr), containing the terms that are being used to create the decision function for the logistic regression.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># clf.get_params()          returns the ITEA parameters</span>
<span class="c1"># clf.bestsol_.get_params() returns the best expression parameters</span>

<span class="n">clf</span><span class="o">.</span><span class="n">bestsol_</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;alpha&#39;: 0.0,
 &#39;beta&#39;: 0.0,
 &#39;expr&#39;: [(&#39;id&#39;, [0, -1, 1, 1]), (&#39;id&#39;, [1, -1, -1, 0])],
 &#39;fitness_f&#39;: None,
 &#39;labels&#39;: array([&#39;sepal length (cm)&#39;, &#39;sepal width (cm)&#39;, &#39;petal length (cm)&#39;,
        &#39;petal width (cm)&#39;], dtype=&#39;&lt;U17&#39;),
 &#39;max_iter&#39;: 100,
 &#39;tfuncs&#39;: {&#39;id&#39;: &lt;function __main__.&lt;lambda&gt;(x)&gt;,
  &#39;sqrt.abs&#39;: &lt;function __main__.&lt;lambda&gt;(x)&gt;,
  &#39;log&#39;: &lt;function jax._src.numpy.lax_numpy._one_to_one_unop.&lt;locals&gt;.&lt;lambda&gt;(x)&gt;,
  &#39;exp&#39;: &lt;function jax._src.numpy.lax_numpy._one_to_one_unop.&lt;locals&gt;.&lt;lambda&gt;(x)&gt;}}
</pre></div></div>
</div>
</section>
<section id="Inspecting-the-results-from-ITEA_classifier-and-ITExpr_classifier">
<h2>Inspecting the results from <code class="docutils literal notranslate"><span class="pre">ITEA_classifier</span></code> and <code class="docutils literal notranslate"><span class="pre">ITExpr_classifier</span></code><a class="headerlink" href="#Inspecting-the-results-from-ITEA_classifier-and-ITExpr_classifier" title="Permalink to this heading"></a></h2>
<p>Now that we have fitted the ITEA, our <code class="docutils literal notranslate"><span class="pre">clf</span></code> contains the <code class="docutils literal notranslate"><span class="pre">bestsol_</span></code> attribute, which is a fitted instance of <code class="docutils literal notranslate"><span class="pre">ITExpr_classifier</span></code> ready to be used.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_itexpr</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">bestsol_</span>

<span class="n">final_itexpr</span><span class="o">.</span><span class="n">to_str</span><span class="p">(</span><span class="n">term_separator</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;[-5.254  0.243  5.012]*id(sepal width (cm)^-1 * petal length (cm) * petal width (cm))\n[ 5.245  0.224 -5.469]*id(sepal length (cm) * sepal width (cm)^-1 * petal length (cm)^-1)\n[ 4.124  3.503 -7.627]&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span>
    <span class="n">y_test</span><span class="p">,</span>
    <span class="n">final_itexpr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span>
    <span class="n">target_names</span><span class="o">=</span><span class="n">targets</span>
<span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
              precision    recall  f1-score   support

      setosa       1.00      1.00      1.00        19
  versicolor       0.94      1.00      0.97        15
   virginica       1.00      0.94      0.97        16

    accuracy                           0.98        50
   macro avg       0.98      0.98      0.98        50
weighted avg       0.98      0.98      0.98        50

</pre></div></div>
</div>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">ITExpr_inspector</span></code> to obtain metrics regarding the IT terms in the expression</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">ITExpr_inspector</span><span class="p">(</span>
        <span class="n">itexpr</span><span class="o">=</span><span class="n">final_itexpr</span><span class="p">,</span> <span class="n">tfuncs</span><span class="o">=</span><span class="n">tfuncs</span>
    <span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span><span class="o">.</span><span class="n">terms_analysis</span><span class="p">()</span>
<span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>coef</th>
      <th>func</th>
      <th>strengths</th>
      <th>coef\nstderr.</th>
      <th>mean pairwise\ndisentanglement</th>
      <th>mean mutual\ninformation</th>
      <th>prediction\nvar.</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[-5.254  0.243  5.012]</td>
      <td>id</td>
      <td>[0, -1, 1, 1]</td>
      <td>[3.978 1.134 1.431]</td>
      <td>0.766</td>
      <td>0.905</td>
      <td>[63.693  0.136 57.947]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[ 5.245  0.224 -5.469]</td>
      <td>id</td>
      <td>[1, -1, -1, 0]</td>
      <td>[14.394  7.012 10.91 ]</td>
      <td>0.766</td>
      <td>0.905</td>
      <td>[2.26  0.004 2.458]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[ 4.124  3.503 -7.627]</td>
      <td>intercept</td>
      <td>---</td>
      <td>[13.579  6.165  7.181]</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>[0. 0. 0.]</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>By using the <code class="docutils literal notranslate"><span class="pre">ITExpr_texifier</span></code>, we can create formatted LaTeX strings of the final expression and its derivatives.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The final expression</span>
<span class="n">display</span><span class="p">(</span><span class="n">Latex</span><span class="p">(</span>
    <span class="s1">&#39;$ ITExpr = &#39;</span> <span class="o">+</span> <span class="n">ITExpr_texifier</span><span class="o">.</span><span class="n">to_latex</span><span class="p">(</span>
        <span class="n">final_itexpr</span><span class="p">,</span>
        <span class="n">term_wrapper</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\underbrace{&#39;</span> <span class="o">+</span> <span class="n">term</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;}_{\text{term &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;}}&#39;</span>
    <span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;$&#39;</span>
<span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="math">
<p><img src="_images/math/18d446a20add0ad493f6e8ed092b2b819bd28fef.png" alt="$ ITExpr = \underbrace{\beta_0 \cdot id(\frac{petal length (cm) \cdot petal width (cm)}{sepal width (cm)})}_{\text{term 0}} + \underbrace{\beta_1 \cdot id(\frac{sepal length (cm)}{sepal width (cm) \cdot petal length (cm)})}_{\text{term 1}} + I_0$"/></p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># List containing the partial derivatives</span>
<span class="n">derivatives_latex</span> <span class="o">=</span> <span class="n">ITExpr_texifier</span><span class="o">.</span><span class="n">derivatives_to_latex</span><span class="p">(</span>
    <span class="n">final_itexpr</span><span class="p">,</span>
    <span class="n">term_wrapper</span><span class="o">=</span><span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\underbrace{&#39;</span> <span class="o">+</span> <span class="n">term</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;}_{\text{term &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39; partial derivative}}&#39;</span>
<span class="p">)</span>

<span class="c1"># displaying one of its derivatives</span>
<span class="n">display</span><span class="p">(</span><span class="n">Latex</span><span class="p">(</span>
    <span class="sa">r</span><span class="s1">&#39;$ \frac{\partial}{\partial &#39;</span> <span class="o">+</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;} ITExpr = &#39;</span> <span class="o">+</span> <span class="n">derivatives_latex</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;$&#39;</span>
<span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="math">
<p><img src="_images/math/b28dc4d8e223ea7732709de2d4b8f4c4028c9516.png" alt="$ \frac{\partial}{\partial sepal length (cm)} ITExpr = \underbrace{1\beta_1 \cdot id'(\frac{sepal length (cm)}{sepal width (cm) \cdot petal length (cm)})(\frac{1}{sepal width (cm) \cdot petal length (cm)})}_{\text{term 1 partial derivative}}$"/></p>
</div></div>
</div>
</section>
<section id="Explaining-the-IT_classifier-expression-using-Partial-Effects">
<h2>Explaining the <code class="docutils literal notranslate"><span class="pre">IT_classifier</span></code> expression using Partial Effects<a class="headerlink" href="#Explaining-the-IT_classifier-expression-using-Partial-Effects" title="Permalink to this heading"></a></h2>
<p>Now let’s create an instance of <code class="docutils literal notranslate"><span class="pre">ITExpr_explainer</span></code>.</p>
<p>We can calculate feature importances with Partial Effects (PE) or approximate the Shapley values using PE. There is also support to use Integrated Gradients as a feature importance method.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First lets create and fit the explainer with training data</span>

<span class="n">explainer</span> <span class="o">=</span> <span class="n">ITExpr_explainer</span><span class="p">(</span>
    <span class="n">itexpr</span><span class="o">=</span><span class="n">final_itexpr</span><span class="p">,</span>
    <span class="n">tfuncs</span><span class="o">=</span><span class="n">tfuncs</span>
<span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">method</span><span class="p">,</span> <span class="n">method_name</span> <span class="ow">in</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;pe&#39;</span><span class="p">,</span>      <span class="s1">&#39;Partial Effects&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;shapley&#39;</span><span class="p">,</span> <span class="s1">&#39;Shapley Values&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;ig&#39;</span><span class="p">,</span>      <span class="s1">&#39;Integrated Gradients&#39;</span><span class="p">)</span>
<span class="p">]:</span>
    <span class="n">explainer</span><span class="o">.</span><span class="n">plot_feature_importances</span><span class="p">(</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">,</span>
        <span class="n">importance_method</span> <span class="o">=</span> <span class="n">method</span><span class="p">,</span>
        <span class="n">grouping_threshold</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">target</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">barh_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;edgecolor&#39;</span> <span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">},</span>
        <span class="n">show</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span>

    <span class="c1"># when we call a plot function, the explainers&#39; axes_</span>
    <span class="c1"># will be the axes of the last plot. we called the plot function</span>
    <span class="c1"># with show=False to access the plot to add a title and then</span>
    <span class="c1"># we explicitly used the show() method to display the plots</span>
    <span class="n">explainer</span><span class="o">.</span><span class="n">axes_</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">method_name</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/_multiclass_example_18_0.png" src="_images/_multiclass_example_18_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/_multiclass_example_18_1.png" src="_images/_multiclass_example_18_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/_multiclass_example_18_2.png" src="_images/_multiclass_example_18_2.png" />
</div>
</div>
<p>We can explain a single instance as well:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">explainer</span><span class="o">.</span><span class="n">plot_feature_importances</span><span class="p">(</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">X_test</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">importance_method</span> <span class="o">=</span> <span class="s1">&#39;pe&#39;</span><span class="p">,</span> <span class="c1"># change to &#39;shapley&#39;</span>
    <span class="n">grouping_threshold</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">target</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">barh_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;edgecolor&#39;</span> <span class="p">:</span> <span class="s1">&#39;k&#39;</span><span class="p">},</span>
    <span class="n">show</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/_multiclass_example_20_0.png" src="_images/_multiclass_example_20_0.png" />
</div>
</div>
<p>Instead of looking into the average Partial Effects, we can plot the Partial Effects for each variable when its co-variables are fixed at the means.</p>
<p>One phenomenon that can occur in a multiclassification problem is to have one class being a baseline, which is observed below. This explains why the feature importance shoud be summed for all classes.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">explainer</span><span class="o">.</span><span class="n">plot_partial_effects_at_means</span><span class="p">(</span>
    <span class="n">X</span>          <span class="o">=</span> <span class="n">X_test</span><span class="p">,</span> <span class="c1"># Obtaining explanations for test data</span>
    <span class="n">ax</span>         <span class="o">=</span> <span class="n">axs</span><span class="p">,</span>
    <span class="n">features</span>   <span class="o">=</span> <span class="n">final_itexpr</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span>
    <span class="n">target</span>     <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">num_points</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="n">share_y</span>    <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show_err</span>   <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">show</span>       <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/_multiclass_example_22_0.png" src="_images/_multiclass_example_22_0.png" />
</div>
</div>
<p>We can share the y axis and show errors hatchs:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">explainer</span><span class="o">.</span><span class="n">plot_partial_effects_at_means</span><span class="p">(</span>
    <span class="n">X</span>          <span class="o">=</span> <span class="n">X_test</span><span class="p">,</span> <span class="c1"># Obtaining explanations for test data</span>
    <span class="n">ax</span>         <span class="o">=</span> <span class="n">axs</span><span class="p">,</span>
    <span class="n">features</span>   <span class="o">=</span> <span class="n">final_itexpr</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span>
    <span class="n">target</span>     <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">num_points</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="n">share_y</span>    <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">show_err</span>   <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">show</span>       <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/_multiclass_example_24_0.png" src="_images/_multiclass_example_24_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">explainer</span><span class="o">.</span><span class="n">plot_normalized_partial_effects</span><span class="p">(</span><span class="n">grouping_threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/_multiclass_example_25_0.png" src="_images/_multiclass_example_25_0.png" />
</div>
</div>
<p>In this example, wew didn’t specified the dictionary with the derivatives of every t ransformation function. <code class="docutils literal notranslate"><span class="pre">ITExpr_explainer</span></code> will use jax library to automatically infer the derivatives, as long as you have used <code class="docutils literal notranslate"><span class="pre">jax.numpy</span></code> instead of the traditional <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.</p>
<p>This means that, after fitting the <code class="docutils literal notranslate"><span class="pre">ITExpr_explainer</span></code>, we have an dictionary of the vectorized version of the derivatives for each transformation function!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># printing the derivative of sin, without having to implement it by hand</span>
<span class="c1"># (remember that is a vectorized function, and the input should be a np array)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="n">explainer</span><span class="o">.</span><span class="n">tfuncs_dx</span><span class="p">[</span><span class="s1">&#39;log&#39;</span><span class="p">](</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[1.         0.5        0.33333334]
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="_interacting_with_protodash.html" class="btn btn-neutral float-left" title="Interacting with ProtoDash" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="_regression_example.html" class="btn btn-neutral float-right" title="California housing regression" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Guilherme Aldeia.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>